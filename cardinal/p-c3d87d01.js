import{g as n}from"./p-9835b40a.js";import{c as e}from"./p-72de6249.js";function t(n){let e=this;Object.keys(n).forEach((function(t){e[t]=n[t]}))}function l(e,t,l,o){let r=this;const i=n(r);return Array.from(i.attributes).filter(n=>n.name.startsWith(l)).forEach(n=>{const o=n.name.split(l)[1];r[o]=t.getChainValue(e?`${e}.${n.value}`:n.value)}),o()}function o(e,t,l,o){let r=this;const i=n(r);return Array.from(i.attributes).filter(n=>n.value.startsWith(l)).forEach(n=>{const o=n.value.split(l)[1],i=e?`${e}.${o}`:o;r[n.name]=t.getChainValue(i),t.onChange(i,(function(){r[n.name]=t.getChainValue(i)}))}),o()}function r(n,e){try{let t=this;if(t.rootModel){let l=n;return t.parentChain&&(l=`${t.parentChain}.${n}`),t.rootModel.setChainValue(l,e),!0}return!1}catch(t){console.error(t)}return!1}function i(e,t,r){if(e||!t)return r();let i,u,a,c=this,f=n(c);if(null!==f.getAttribute("data-view-model")&&"psk-for-each"===f.tagName.toLowerCase())return i=f.getAttribute("data-view-model"),c.__assignProperties.call(c,{rootModel:t,parentChain:a=i}),r();if(i=f.getAttribute("view-model"),a=i,null===i&&(null!==(u=null===f.getAttribute("name")||f.getAttribute("name").startsWith("@")?null:f.getAttribute("name"))||null===f.getAttribute("label")||f.getAttribute("label").startsWith("@")||(u=f.getAttribute("label").replace(/( |:|\/|\.|-)/g,"").toLowerCase()),a=u),!i&&!u)return o.call(c,a,t,"@",r),l.call(c,a,t,"view-model-",r),r();function s(n,e){c[n]=t.getChainValue(e),t.onChange(e,(function(){c[n]=t.getChainValue(e)}))}if(c.__assignProperties.call(c,{rootModel:t,parentChain:a}),i){let n=t.getChainValue(a);return n?(Object.keys(n).forEach(n=>{s(n,`${a}.${n}`)}),function(){const n=`${a}.value`;if(!t.getChainValue(a)||t.getChainValue(n))return r();s("value",n)}(),r()):r()}return r()}function u(){return l=>{let{componentWillLoad:o,render:u}=l;l.componentWillLoad=function(){let l=this,a=n(l);return l.render=u,l.changeModel=r,l.__assignProperties=t,a.isConnected?0===a.getAttributeNames().filter(n=>"data-view-model"===n.toLowerCase()||!!n.toLowerCase().includes("view-model")||!!a.getAttribute(n).toLowerCase().startsWith("@")).length?o&&o.call(l):new Promise(n=>{!function(n){e("getModelEvent",{bubbles:!0,composed:!0,cancellable:!0,detail:{callback:function(e,t){i.apply(l,[e,t,n])}}},!0,a)}(()=>{n(o&&o.call(l))})}):o&&o.call(l)}}}export{u as B};