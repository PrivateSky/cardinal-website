import{g as e}from"./p-9835b40a.js";import{b as t,c as n}from"./p-acb9d1e1.js";import{a as r,c as i}from"./p-7111d76e.js";function l(e,r){if(r.hasAttribute(t)){let n=r.getAttribute(t).trim();return void 0!==e.getChainValue(n)}if(r.hasAttribute(n)){let t=r.getAttribute(n).split("|");if(2!==t.length)return!1;let i=t[0].trim();return t[1].trim()===e.getChainValue(i)}return!0}function o(e){let t=this;Object.keys(e).forEach((function(n){t[n]=e[n]}))}function a(e,t,n,i,l){let o=this;return Array.from(i.attributes).filter(e=>e.name.startsWith(n)).forEach(l=>{const a=l.name.split(n)[1],u=r(a),c=e?`${e}.${l.value}`:l.value,d=t.getChainValue(c);i.setAttribute(a,d),o[u]=t.getChainValue(c)}),l()}function u(e,t,n,i,l){let o=this;return Array.from(i.attributes).filter(e=>e.value.startsWith(n)).forEach(l=>{const a=l.value.split(n)[1],u=e?`${e}.${a}`:a,c=r(l.name);if(t.hasExpression(u))o[c]=t.evaluateExpression(u);else{const e=t.getChainValue(u);i.setAttribute(l.name,e),o[c]=e,t.onChange(u,(function(){o[c]=t.getChainValue(u)}))}}),l()}function c(e,t){try{let n=this;if(n.rootModel){let r=e;return n.parentChain&&(r=`${n.parentChain}.${e}`),n.rootModel.setChainValue(r,t),!0}return!1}catch(n){console.error(n)}return!1}function d(t,n,r){if(t||!n)return r();let i,o,c,d=this,f=e(d);if(!l(n,f))return f.setAttribute("data-hide","hide"),r();if(f.removeAttribute("data-hide"),null!==f.getAttribute("data-view-model")&&"psk-for-each"===f.tagName.toLowerCase())return i=f.getAttribute("data-view-model"),d.__assignProperties.call(d,{rootModel:n,parentChain:c=i}),r();if(i=f.getAttribute("view-model"),c=i,null===i&&(null!==(o=null===f.getAttribute("name")||f.getAttribute("name").startsWith("@")?null:f.getAttribute("name"))||null===f.getAttribute("label")||f.getAttribute("label").startsWith("@")||(o=f.getAttribute("label").replace(/( |:|\/|\.|-)/g,"").toLowerCase()),c=o),!i&&!o)return u.call(d,c,n,"@",f,r),a.call(d,c,n,"view-model-",f,r),r();function s(e,t){d[e]=n.getChainValue(t),n.onChange(t,(function(){d[e]=n.getChainValue(t)}))}if(d.__assignProperties.call(d,{rootModel:n,parentChain:c}),i){let e=n.getChainValue(c);return e?(Object.keys(e).forEach(e=>{s(e,`${c}.${e}`)}),function(){const e=`${c}.value`;if(!n.getChainValue(c)||n.getChainValue(e))return r();s("value",e)}(),r()):r()}return r()}function f(){return t=>{let{componentWillLoad:n,render:r}=t;t.render=function(){let t=e(this),n=t.className;return t.className="hide"===t.getAttribute("data-hide")?`${n} hidden`:n.replace(" hidden",""),r&&r.call(this)},t.componentWillLoad=function(){let t=this,r=e(t);return t.changeModel=c,t.__assignProperties=o,r.isConnected?0===r.getAttributeNames().filter(e=>"data-view-model"===e.toLowerCase()||!!e.toLowerCase().includes("view-model")||!!r.getAttribute(e).toLowerCase().startsWith("@")).length?n&&n.call(t):new Promise(e=>{!function(e){i("getModelEvent",{bubbles:!0,composed:!0,cancellable:!0,detail:{callback:function(n,r){d.apply(t,[n,r,e])}}},!0,r)}(()=>{e(n&&n.call(t))})}):n&&n.call(t)}}}export{f as B,l as _};